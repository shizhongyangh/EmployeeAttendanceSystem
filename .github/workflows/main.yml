name: Push All to Vercel Branch

on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: 1. æ£€å‡ºæºç  ğŸ›ï¸
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: 2. é…ç½® Git èº«ä»½ âš™ï¸
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"

      - name: 3. å¼ºåˆ¶æ¨é€æ‰€æœ‰æ–‡ä»¶åˆ° Vercel åˆ†æ”¯ ğŸš€
        run: |
          # åˆ‡æ¢åˆ°æ–°åˆ†æ”¯ï¼ˆä¿ç•™ç°æœ‰æ–‡ä»¶ï¼‰
          git checkout --orphan vercel
          git add -A
          git commit -m "Full push: ${{ github.sha }}"
          git remote set-url origin https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}
          git push origin vercel --force
